// styles/tokens/_typography.scss - Fluid Typography Scale
// Responsive typography with clamp() functions for optimal readability across devices

// Import modules for modern Sass functions
@use "sass:map";

// Base font settings
$font-sans: system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
$font-mono: 'SF Mono', 'Monaco', 'Inconsolata', 'Fira Code', monospace;

// Font weights (following Material Design 3 scale)
$font-weight-thin: 100;
$font-weight-light: 300;
$font-weight-regular: 400;
$font-weight-medium: 500;
$font-weight-semibold: 600;
$font-weight-bold: 700;
$font-weight-black: 900;

// Fluid typography scale - responsive sizing with clamp()
// Base viewport units for fluid scaling, with readable min/max bounds

$typography-scale: (
  // Display sizes (for headings on large screens)
  'display-lg': (
    'size': clamp(3rem, 6vw, 4rem),        // 48px → 64px
    'line-height': 1.15,
    'weight': $font-weight-medium,
    'letter-spacing': -0.02em,
  ),
  'display-md': (
    'size': clamp(2.25rem, 4.5vw, 3rem),   // 36px → 48px
    'line-height': 1.2,
    'weight': $font-weight-medium,
    'letter-spacing': -0.02em,
  ),
  'display-sm': (
    'size': clamp(1.875rem, 3.5vw, 2.25rem), // 30px → 36px
    'line-height': 1.25,
    'weight': $font-weight-medium,
    'letter-spacing': -0.01em,
  ),

  // Headline sizes
  'headline-lg': (
    'size': clamp(2rem, 3vw, 2.25rem),     // 32px → 36px
    'line-height': 1.3,
    'weight': $font-weight-regular,
  ),
  'headline-md': (
    'size': clamp(1.75rem, 2.5vw, 2rem),    // 28px → 32px
    'line-height': 1.35,
    'weight': $font-weight-regular,
  ),
  'headline-sm': (
    'size': clamp(1.5rem, 2vw, 1.75rem),    // 24px → 28px
    'line-height': 1.4,
    'weight': $font-weight-regular,
  ),

  // Title sizes
  'title-lg': (
    'size': clamp(1.375rem, 1.5vw, 1.5rem),  // 22px → 24px
    'line-height': 1.45,
    'weight': $font-weight-medium,
  ),
  'title-md': (
    'size': clamp(1.25rem, 1.25vw, 1.25rem), // 20px → 20px
    'line-height': 1.5,
    'weight': $font-weight-medium,
  ),
  'title-sm': (
    'size': clamp(1.125rem, 1vw, 1.125rem),   // 18px → 18px
    'line-height': 1.55,
    'weight': $font-weight-medium,
  ),

  // Body and label sizes
  'body-lg': (
    'size': clamp(1rem, 1.25vw, 1.125rem),    // 16px → 18px
    'line-height': 1.6,
    'weight': $font-weight-regular,
  ),
  'body-md': (
    'size': clamp(0.875rem, 1vw, 1rem),       // 14px → 16px
    'line-height': 1.65,
    'weight': $font-weight-regular,
  ),
  'body-sm': (
    'size': clamp(0.75rem, 0.75vw, 0.875rem),  // 12px → 14px
    'line-height': 1.7,
    'weight': $font-weight-regular,
  ),

  // Label sizes (for buttons, inputs, etc.)
  'label-lg': (
    'size': clamp(0.875rem, 1vw, 1rem),        // 14px → 16px
    'line-height': 1.5,
    'weight': $font-weight-medium,
  ),
  'label-md': (
    'size': clamp(0.75rem, 0.75vw, 0.875rem),   // 12px → 14px
    'line-height': 1.55,
    'weight': $font-weight-medium,
  ),
  'label-sm': (
    'size': clamp(0.6875rem, 0.625vw, 0.75rem), // 11px → 12px
    'line-height': 1.6,
    'weight': $font-weight-medium,
  ),
);

// Legacy typography scale for backwards compatibility
$typography-legacy: (
  'xs': clamp(0.75rem, 0.7rem + 0.25vw, 0.875rem),    // 12px → 14px
  'sm': clamp(0.875rem, 0.8rem + 0.375vw, 1rem),      // 14px → 16px
  'md': clamp(1rem, 0.95rem + 0.25vw, 1.125rem),      // 16px → 18px
  'lg': clamp(1.125rem, 1rem + 0.625vw, 1.25rem),     // 18px → 20px
  'xl': clamp(1.25rem, 1.1rem + 0.75vw, 1.5rem),      // 20px → 24px
  '2xl': clamp(1.5rem, 1.3rem + 1vw, 2rem),           // 24px → 32px
  '3xl': clamp(1.875rem, 1.5rem + 1.875vw, 2.5rem),   // 30px → 40px
  '4xl': clamp(2.25rem, 1.75rem + 2.5vw, 3rem),       // 36px → 48px
);

// Generate CSS custom properties
:root {
  // Font families
  --font-family-sans: #{$font-sans};
  --font-family-mono: #{$font-mono};

  // New design tokens
  @each $name, $props in $typography-scale {
    --font-size-#{$name}: #{map.get($props, 'size')};
    --line-height-#{$name}: #{map.get($props, 'line-height')};
    --font-weight-#{$name}: #{map.get($props, 'weight')};

    @if map.has-key($props, 'letter-spacing') {
      --letter-spacing-#{$name}: #{map.get($props, 'letter-spacing')};
    }
  }

  // Legacy support
  @each $name, $value in $typography-legacy {
    --font-size-#{$name}: #{$value};
  }
}

// Typography utility classes (optional - for direct usage)
.typography {
  @each $name, $props in $typography-scale {
    &-#{$name} {
      font-size: var(--font-size-#{$name});
      line-height: var(--line-height-#{$name});
      font-weight: var(--font-weight-#{$name});

      @if map.has-key($props, 'letter-spacing') {
        letter-spacing: var(--letter-spacing-#{$name});
      }
    }
  }
}

// Mixin for semantic typography application
@mixin typography($size) {
  @if map.has-key($typography-scale, $size) {
    $props: map.get($typography-scale, $size);
    font-size: map.get($props, 'size');
    line-height: map.get($props, 'line-height');
    font-weight: map.get($props, 'weight');

    @if map.has-key($props, 'letter-spacing') {
      letter-spacing: map.get($props, 'letter-spacing');
    }
  } @else {
    @warn "#{$size} is not a valid typography scale. Available sizes: #{map-keys($typography-scale)}";
  }
}

// Responsive reading experience optimization
@media (max-width: 768px) {
  :root {
    // Reduce some sizes on mobile for better readability
    --line-height-display-lg: 1.1;
    --line-height-display-md: 1.15;
    --line-height-display-sm: 1.2;
  }
}

// High contrast mode support
@media (prefers-contrast: high) {
  :root {
    // Increase font weights for better accessibility
    --font-weight-display-lg: #{$font-weight-bold};
    --font-weight-display-md: #{$font-weight-semibold};
    --font-weight-display-sm: #{$font-weight-semibold};
  }
}
